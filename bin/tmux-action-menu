#!/bin/bash

buffer="$(cat)"

if [[ $buffer =~ (0x[0-9a-fA-F]{64})([^0-9a-zA-Z]|$) ]] ||
   [[ $buffer =~ (0x[0-9a-fA-F]{32})([^0-9a-zA-Z]|$) ]] ||
   [[ $buffer =~ ([a-z0-9]+\.eth([^.0-9a-zA-Z]|$)) ]]
then
    ref="${BASH_REMATCH[1]}"
    # echo "Matched: [$ref]"
    # exit 0
    tmux display-menu -T "EVM transaction actions" \
         blockscan.com b \
             "run -b 'url-handler \"https://blockscan.com/search?f=0&q=$ref\" >/dev/null'"
         etherscan.io e \
             "run -b 'url-handler \"https://etherscan.io/search?f=0&q=$ref\" >/dev/null'" \
         polygonscan.com p \
             "run -b 'url-handler \"https://polygonscan.com/search?f=0&q=$ref\" >/dev/null'" \
         mumbai.polygonscan.com m \
             "run -b 'url-handler \"https://mumbai.polygonscan.com/search?f=0&q=$ref\" >/dev/null'" \

    exit 0
fi

tmux display-message "No actions for $buffer"
